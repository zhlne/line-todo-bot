# ğŸ“Œ LINE Bot æ™ºæ…§æé†’ç³»çµ±

é€™æ˜¯ä¸€å¥—å¯éƒ¨ç½²çš„ LINE Bot æé†’æ‡‰ç”¨ç³»çµ±ï¼Œç”¨æˆ¶å¯é€éç°¡å–®æ–‡å­—æŒ‡ä»¤ï¼Œæ“ä½œæ–°å¢ã€æŸ¥è©¢èˆ‡åˆªé™¤æé†’äº‹é …ã€‚ç³»çµ±æœƒåœ¨æŒ‡å®šæ™‚é–“è‡ªå‹•æ¨é€æé†’è¨Šæ¯ï¼Œé©åˆæ—¥å¸¸ç”Ÿæ´»ä»»å‹™å®‰æ’èˆ‡å‚™å¿˜éœ€æ±‚ã€‚

---

## âœ… æ”¯æ´æŒ‡ä»¤

| æŒ‡ä»¤ç¯„ä¾‹ | åŠŸèƒ½èªªæ˜ |
|----------|----------|
| `æ–°å¢ HH:MM æé†’å…§å®¹` | æ–°å¢æé†’ï¼Œä¾‹å¦‚ï¼š`æ–°å¢ 08:30 å‡ºé–€æ­è»Š` |
| `æŸ¥è©¢` | æŸ¥è©¢ç›®å‰æ‰€æœ‰æé†’äº‹é … |
| `åˆªé™¤ æé†’å…§å®¹` | åˆªé™¤ç‰¹å®šæé†’ï¼Œä¾‹å¦‚ï¼š`åˆªé™¤ å‡ºé–€æ­è»Š` |
| `åˆªé™¤å…¨éƒ¨` | ä¸€æ¬¡åˆªé™¤ç›®å‰ç”¨æˆ¶çš„æ‰€æœ‰æé†’è³‡æ–™ï¼ˆâš ï¸ ä¸å¯å¾©åŸï¼‰ |

---

## ğŸ•’ åŠŸèƒ½ç°¡ä»‹

- ğŸ“© é€é LINE Bot Webhook æ¥æ”¶æŒ‡ä»¤
- â° ä½¿ç”¨ APScheduler æ¯åˆ†é˜è‡ªå‹•æ¯”å°ç›®å‰æ™‚é–“ï¼ˆæ”¯æ´å°ç£æ™‚å€ UTC+8ï¼‰
- ğŸ”” æ™‚é–“åˆ°å³è‡ªå‹•é€é Push Message å‚³é€æé†’
- ğŸ§‘â€ğŸ’¼ æ¯ä½ç”¨æˆ¶è³‡æ–™ç¨ç«‹å„²å­˜ï¼ˆä¾ user_id å€åˆ†ï¼‰
- â˜ï¸ å¯éƒ¨ç½²æ–¼ Renderã€Heroku ç­‰æ”¯æ´ Python Web App çš„é›²å¹³å°

---

## ğŸ§± ä½¿ç”¨æŠ€è¡“

| åˆ†é¡ | æŠ€è¡“ |
|------|------|
| Web æ‡‰ç”¨æ¡†æ¶ | Flask |
| è³‡æ–™åº« ORM | Flask-SQLAlchemy |
| å®šæ™‚æ’ç¨‹æ¨¡çµ„ | Flask-APScheduler |
| å³æ™‚é€šè¨Šä¸²æ¥ | LINE Bot SDK v3 |
| è³‡æ–™å„²å­˜ | PostgreSQL |
| é›²ç«¯éƒ¨ç½² | Render + Gunicorn |

---

## ğŸ“¦ ç›¸ä¾å¥—ä»¶ï¼ˆrequirements.txtï¼‰

```
Flask==2.3.3
flask_sqlalchemy==3.1.1
flask_apscheduler==1.13.1
line-bot-sdk==3.4.0
gunicorn
psycopg2-binary
```

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
â”œâ”€â”€ app.py              # ä¸»æ‡‰ç”¨å…¥å£ï¼Œè™•ç†æŒ‡ä»¤é‚è¼¯èˆ‡ Webhook
â”œâ”€â”€ models.py           # ä»»å‹™è³‡æ–™æ¨¡å‹ï¼ˆTaskï¼‰
â”œâ”€â”€ reminder.py         # æ¯åˆ†é˜æª¢æŸ¥æé†’ä¸¦æ¨æ’­
â”œâ”€â”€ requirements.txt    # ç›¸ä¾å¥—ä»¶æ¸…å–®
â”œâ”€â”€ render.yaml / Procfile  # é›²ç«¯éƒ¨ç½²è¨­å®š
```

---

# æˆ‘çš„åˆ†æå ±å‘Š

ä»¥ä¸‹æ˜¯æœ¬ç ”ç©¶çš„åˆ†ææµç¨‹åœ–ï¼š

```mermaid
graph TD
    %% å®šç¾©ç¯€é»æ¨£å¼ (Styles Definition)
    classDef process fill:#E3F2FD,stroke:#1565C0,stroke-width:2px,color:#000;
    classDef decision fill:#FFF9C4,stroke:#FBC02D,stroke-width:2px,color:#000;
    classDef terminator fill:#E8F5E9,stroke:#2E7D32,stroke-width:2px,color:#000;
    %% å®šç¾©åˆ†æµè·¯å¾‘æ¨£å¼
    classDef pathA fill:#FBE9E7,stroke:#D84315,stroke-width:2px,color:#000; %% ç´…è‰²ç³»ä»£è¡¨é€£çºŒè®Šæ•¸è·¯å¾‘
    classDef pathB fill:#F3E5F5,stroke:#8E24AA,stroke-width:2px,color:#000; %% ç´«è‰²ç³»ä»£è¡¨é¡åˆ¥è®Šæ•¸è·¯å¾‘

    %% ä¸»æµç¨‹é–‹å§‹ (Main Flow Start)
    Start([é–‹å§‹: å£½éšªé¢¨éšªæ•¸æ“šçµ±è¨ˆåˆ†æ]):::terminator --> P1[1. è³‡æ–™å‰è™•ç†<br/>è®€å– train.csv, ç¢ºèªè®Šæ•¸å‹æ…‹]:::process
    P1 --> P2[æ’é™¤ Id ç­‰ç„¡æ•ˆè­˜åˆ¥è®Šæ•¸]:::process
    P2 --> D1{2. ç›®æ¨™è®Šæ•¸ç¢ºèª<br/>Response æ˜¯å¦ç‚ºå¤šé¡åˆ¥?<br/>(æœ¬ç ”ç©¶ç‚º 8 é¡)}:::decision
    D1 -- "æ˜¯ (å±¬æ–¼3é¡åˆ¥ä»¥ä¸Šæƒ…å¢ƒ)" --> P3[å•Ÿå‹•åˆ†æµæª¢å®šç­–ç•¥]:::process
    
    %% åˆ†æµæ±ºç­–é» (Branching Point)
    P3 --> D2{3. åˆ¤æ–·é æ¸¬è®Šæ•¸é¡å‹}:::decision

    %% --- è·¯å¾‘ A: é€£çºŒå‹è®Šæ•¸åˆ†æ (Path A: Continuous Variables) ---
    D2 -- "è·¯å¾‘ A: é€£çºŒå‹è®Šæ•¸<br/>(å¦‚ BMI, Ins_Age)" --> A1[æª¢æŸ¥å¸¸æ…‹åˆ†ä½ˆå‡è¨­<br/>(å¤§æ¨£æœ¬ä¸‹é€šå¸¸è¦–ç‚ºç¬¦åˆ)]:::pathA
    A1 --> A2[åŸ·è¡Œ å–®å› å­è®Šç•°æ•¸åˆ†æ<br/>(One-Way ANOVA)]:::pathA
    A2 --> AD1{p-value < 0.05?}:::decision
    AD1 -- "æ˜¯ (é¡¯è‘—)" --> A3[çµè«–: è‡³å°‘æœ‰ä¸€çµ„å¹³å‡æ•¸ä¸åŒ<br/>(æ‹’çµ• H0)]:::pathA
    A3 -.- A3_1[å¯é¸æ­¥é©Ÿ: äº‹å¾Œæª¢å®š Post-hoc<br/>(å¦‚ Tukey HSD ç¢ºèªå·®ç•°ä¾†æº)]:::pathA
    AD1 -- "å¦" --> A4[çµè«–: çµ„é–“ç„¡é¡¯è‘—å·®ç•°]:::pathA

    %% --- è·¯å¾‘ B: é¡åˆ¥å‹è®Šæ•¸åˆ†æ (Path B: Categorical Variables) ---
    D2 -- "è·¯å¾‘ B: é¡åˆ¥å‹è®Šæ•¸<br/>(å¦‚ Product_Info, Medical_Keyword)" --> B1[å»ºç«‹åˆ—è¯è¡¨<br/>(Contingency Table)]:::pathB
    B1 --> B2[æª¢æŸ¥æ¯å€‹å–®å…ƒæ ¼çš„æœŸæœ›å€¼<br/>(Expected Count)]:::pathB
    B2 --> BD1{æ‰€æœ‰å–®å…ƒæ ¼æœŸæœ›å€¼ >= 5?}:::decision
    BD1 -- "æ˜¯" --> B3[åŸ·è¡Œ çš®çˆ¾æ£®å¡æ–¹ç¨ç«‹æ€§æª¢å®š<br/>(Pearson Chi-Square Test)]:::pathB
    BD1 -- "å¦ (ä»»ä¸€æ ¼ < 5)" --> B4[åŸ·è¡Œ Fisher ç²¾ç¢ºæª¢å®š<br/>(Fisher's Exact Test)]:::pathB
    B3 --> BD2{p-value < 0.05?}:::decision
    B4 --> BD2
    BD2 -- "æ˜¯ (é¡¯è‘—)" --> B5[çµè«–: è®Šæ•¸èˆ‡é¢¨éšªç­‰ç´šå…·é—œè¯æ€§<br/>(éç¨ç«‹)]:::pathB
    BD2 -- "å¦" --> B6[çµè«–: è®Šæ•¸èˆ‡é¢¨éšªç­‰ç´šç¨ç«‹]:::pathB

    %% çµæœå½™æ•´èˆ‡çµæŸ (Consolidation & End)
    A3 --> M1[4. çµæœå½™æ•´<br/>è£½ä½œçµ±è¨ˆè¡¨æ ¼ä¸¦æ¨™è¨» p-value]:::process
    A4 --> M1
    B5 --> M1
    B6 --> M1
    M1 --> M2[5. çµè«–æ¨å°<br/>æ ¹æ“šé¡¯è‘—æ€§çµæœè­˜åˆ¥é—œéµé¢¨éšªå› å­]:::process
    M2 --> End([çµæŸ]):::terminator

    %% é€£çµæ¨£å¼åˆ°ç¯€é» (Apply styles to nodes in paths)
    class A1,A2,A3,A4,A3_1 pathA;
    class B1,B2,B3,B4,B5,B6 pathB;
```
